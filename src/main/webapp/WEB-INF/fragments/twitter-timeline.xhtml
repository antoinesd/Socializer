<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html" xmlns:p="http://primefaces.org/ui">
    <p:dataList id="#{id}" var="tweet" type="none" value="#{timeline}" styleClass="rounded-5">
        <p:column>
            <div class="status tweet">
                <h:panelGrid columns="2" width="100%" columnClasses="avatar,verticalTop">
                    <h:panelGroup>
                        <p:graphicImage id="pict" value="#{tweet.profileImageUrl}" height="48" width="48"
                            styleClass="rounded-5 tooltip-top" title="#{tweet.fromUser}" />
                    </h:panelGroup>
                    <h:panelGroup>
                        <!--<h:outputText value="@#{twitterUserServiceImpl.getUserProfile(tweet.fromUser).fullName}" styleClass="author"/>-->
                        <!--<br/> -->

                        <p>
                            <h:outputLink value="https://twitter.com/#!/#{tweet.fromUser}" styleClass="author">
                                <h:outputText value="@#{tweet.fromUser}" styleClass="label" />
                            </h:outputLink>

                            <h:outputText value="#{tweet.createdAt}" styleClass="tweetInfo">
                                <f:converter converterId="org.ocpsoft.PrettyTimeConverter" />
                            </h:outputText>

                            <h:panelGroup rendered="#{!empty(tweet.source)}">
                                <h:outputText value=", via  #{tweet.source}" escape="false" styleClass="tweetInfo" />
                            </h:panelGroup>
                        </p>

                        <p>
                            <h:outputText value="${tweet.text}" escape="false" />
                        </p>
                        <!--${tweet.languageCode}-->
                        <!--<br/>-->

                        <p:panel
                            header="En réponse à @#{twitterTimelineServiceImpl.getStatus(tweet.inReplyToStatusId).fromUser}"
                            toggleable="true" rendered="#{not empty tweet.inReplyToStatusId}">
                            <h:outputText value="#{twitterTimelineServiceImpl.getStatus(tweet.inReplyToStatusId).text}"
                                styleClass="reponse" />

                        </p:panel>
                    </h:panelGroup>
                </h:panelGrid>

                <div class="actions">
                    <p:commandButton actionListener="a" icon="ui-icon ui-icon-arrowreturnthick-1-w" title="Répondre"
                        update="#{id}" styleClass="tooltip-bottom" />
                    <p:commandButton actionListener="#{twitterTimelineServiceImpl.addToFavorites(tweet.id)}"
                        icon="ui-icon ui-icon-star" title="Add to favorites" update="#{id}" styleClass="tooltip-bottom" />
                    <p:commandButton actionListener="#{twitterTimelineServiceImpl.retweet(tweet.id)}" icon="retweet"
                        title="Retweet" update="#{id}" styleClass="tooltip-bottom" />
                </div>
            </div>
        </p:column>
    </p:dataList>
    <p:poll interval="120" update="#{id}" />
</ui:composition>